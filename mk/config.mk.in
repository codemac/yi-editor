#
# System-specific settings
#

PREFIX=         @prefix@
BINDIR=         @prefix@/bin
LIBDIR=         @prefix@/lib/$(PKG)
DATADIR=        @prefix@/share/doc/$(PKG)
MANDIR=         @prefix@/man
IFACEDIR=       $(LIBDIR)/imports

GHC=            @WithGhc@
HC_OPTS=        -Wall -Werror
HC_OPTS+=       -Icbits -Imk

# optimisation flags
HC_OPTS+=       -funbox-strict-fields -O2

#
# With ghc-6.4 -fvia-C produces a buggy binary, dying with:
#       user error (Curses[-1]:keypad)
#       yi-static: user error (Curses[-1]:keypad)
# HEAD of ghc, (at least as early as) May 17 2005 or later seems to fix this.
# 
#HC_OPTS+=       -fvia-C
#
# If you don't have 6.2.2 or 6.5, you instead need:

HC_OPTS+=       -fasm

# And we want this no matter what.
HC_OPTS+=       -threaded

#HC_OPTS+=      -debug 
#HC_OPTS+=      -fignore-asserts 

# Useful development settings:
#HC_OPTS+=       -Onot -fasm -H64m

GHC_VERSION=	@GHC_VERSION@
GLASGOW_HASKELL=@GLASGOW_HASKELL@

ifeq "$(GLASGOW_HASKELL)" "602"
HC_OPTS+=       -package posix
endif

GHC_PKG=        @GhcPkgCmd@
HSC2HS=         @Hsc2hsCmd@

HADDOCK=        @HaddockCmd@
HADDOCK_OPTS=   -h -D html/yi.interface

HAPPY=          @HappyCmd@
HAPPY_OPTS=     -gac

ALEX=           @AlexCmd@
ALEX_OPTS=      -g

AR=             ar
AR_OPTS=        cr

LD=             @LdCmd@
LD_X=           @LdCmd@ @LdXFlag@

RANLIB=         @RANLIB@
STRIP=          @STRIP@

INSTALL=        sh $(TOPDIR)/install-sh -c
INSTALL_PROGRAM=$(INSTALL) -m 755
INSTALL_DATA=   $(INSTALL) -m 644
INSTALL_DIR=    mkdir -p

CP=             cp
RM=             rm -f

#
# Extra paths to find things
#
LD_OPTS=        @LDFLAGS@
INC_OPTS=       @CPPFLAGS@
C_OPTS=         @CFLAGS@
LIBS=           @LIBS@

#
# Special libs needed in package.conf files
#
CURSES=         @CURSES@
# ICONV=          @ICONV@

# extra symbols
SYMS=           @SYMS@
